<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Notes · MAVs</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>MAVs</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../intro.html">Home</a></li><li><span class="toctext">Usage</span><ul><li><a class="toctext" href="../tutorials/basic.html">Basic usage</a></li><li><a class="toctext" href="../tutorials/developer.html">Developing MAVs</a></li></ul></li><li><span class="toctext">Sensing</span><ul><li><a class="toctext" href="../packages/model/gazebo/vehicle_description/main.html">vehicle_description</a></li><li><a class="toctext" href="../packages/model/gazebo/contact_sensor/main.html">contact_sensor</a></li></ul></li><li><span class="toctext">Detection</span><ul><li><a class="toctext" href="../packages/computing/perception/obstacle_detector/main.html">obstacle_detector</a></li></ul></li><li><span class="toctext">Vehicle model</span><ul><li><a class="toctext" href="../packages/model/chrono/ros_chrono/main.html">ros_chrono</a></li></ul></li><li><span class="toctext">Planning</span><ul><li><a class="toctext" href="../packages/computing/planning/nloptcontrol_planner/main.html">nloptcontrol_planner</a></li><li><a class="toctext" href="../packages/computing/planning/mavs_ros_planner/main.html">mavs_ros_planner</a></li></ul></li><li><span class="toctext">Miscellaneous</span><ul><li><a class="toctext" href="../packages/system/system_shutdown.html">system_shutdown</a></li><li><a class="toctext" href="../packages/system/data_logging.html">data_logging</a></li><li><a class="toctext" href="../packages/model/chrono/chrono_position_broadcaster/main.html">chrono_position_broadcaster</a></li><li><a class="toctext" href="../packages/model/chrono/ros_chrono_msgs/main.html">ros_chrono_msgs</a></li></ul></li><li><span class="toctext">System demos</span><ul><li><a class="toctext" href="../packages/system/demos/demoA.html">demoA</a></li><li><a class="toctext" href="../packages/system/demos/demoB.html">demoB</a></li><li><a class="toctext" href="../packages/system/demos/demoC.html">demoC</a></li><li><a class="toctext" href="../packages/system/demos/demoD.html">demoD</a></li><li><a class="toctext" href="../packages/system/demos/demoE.html">demoE</a></li><li><a class="toctext" href="../packages/system/demos/demoF.html">demoF</a></li><li><a class="toctext" href="../packages/system/demos/demoG.html">demoG</a></li></ul></li><li><span class="toctext">Docker</span><ul><li><a class="toctext" href="workflow.html">Workflow</a></li><li class="current"><a class="toctext" href="notes.html">Notes</a><ul class="internal"><li><a class="toctext" href="#Basic-Concepts-1">Basic Concepts</a></li><li><a class="toctext" href="#Dockerfile-Commands-1">Dockerfile Commands</a></li><li><a class="toctext" href="#Docker-Commands-1">Docker Commands</a></li><li><a class="toctext" href="#Docker-examples-1">Docker examples</a></li><li><a class="toctext" href="#Docker-hub-1">Docker hub</a></li><li><a class="toctext" href="#How-to-update-base-image-on-docker-hub-1">How to update base image on docker hub</a></li><li><a class="toctext" href="#Pull-and-run-the-image-from-the-remote-repository-1">Pull and run the image from the remote repository</a></li></ul></li></ul></li><li><a class="toctext" href="../testing/main.html">Testing</a></li><li><a class="toctext" href="../issues/main.html">Troubleshooting</a></li></ul></nav><article id="docs"><header><nav><ul><li>Docker</li><li><a href="notes.html">Notes</a></li></ul><a class="edit-page" href="https://github.com/JuliaMPC/AVExamples.jl/blob/master/docs/src/docker/notes.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Notes</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Docker-notes-1" href="#Docker-notes-1">Docker notes</a></h1><h2><a class="nav-anchor" id="Basic-Concepts-1" href="#Basic-Concepts-1">Basic Concepts</a></h2><p>An image is a lightweight, stand-alone, executable package that includes everything needed to run a piece of software, including the code, a runtime, libraries, environment variables, and config files. Docker Hub: A registry of Docker images. You can think of the registry as a directory of all available Docker images. Since the image doesn&#39;t exist locally, the client will first fetch the image from the registry and then run the image. Container: A runtime instance of an image. This is a image becomes in memory when actually executed. Dockerfile: A simple text-file that contains a list of commands that the Docker client calls while creating an image. It&#39;s a simple way to automate the image creation process. In an image, a layer is modification to the image, represented by an instruction in the Dockerfile. Layers are applied in sequence to the base image to create the final image. When an image is updated or rebuilt, only layers that change need to be updated, and unchanged layers are cached locally.</p><h2><a class="nav-anchor" id="Dockerfile-Commands-1" href="#Dockerfile-Commands-1">Dockerfile Commands</a></h2><p>FROM		Load from a base image CMD		Cmd takes the following format CMD [“excutable”, ”params1”, ”params2”] RUN		Run is used to execute any commands. COPY		Copy the folder/ files from the local host source to the destination in the container. ENV		Set the environment variables. USER	Set the (UID) username which is to run the container based on the image being built. VOLUME	Enable access from your container to a directory on the host machine.</p><h2><a class="nav-anchor" id="Docker-Commands-1" href="#Docker-Commands-1">Docker Commands</a></h2><p>docker run &lt;image&gt;	run a docker container based on the image docker ps 			show all containers that are currently running docker ps -a 			show a list of all containers that we ran docker history &lt;image&gt;		view all the layers that make up the image once the image is built docker exec -it &lt;container&gt; /bin/bash	launch the docker from other terminals docker commit &lt;container&gt; &lt;repository[:TAG]&gt;	create a new image from a container’s changes docker kill &lt;container&gt; 	kill one or more running containers docker rm &lt;container&gt; 	remove existing container docker image ls		list image built on the machine docker image rm &lt;container&gt;	remove image nvidia-docker build -t &lt;container&gt; -f &lt;Dockerfile&gt; nvidia-docker run -it –rm 		automatically remove the container when it exits. –volume list	bind mount a volume –env list		set environment variables -u		user or UID (i.e. mavs) –privileged	give extended privileges to this container</p><h2><a class="nav-anchor" id="Docker-examples-1" href="#Docker-examples-1">Docker examples</a></h2><p>Save changes made in docker container: docker ps -l	find the container ID docker commit &lt;container_id&gt; [repository[:tag]]    Change the docker name tag in ./run.sh</p><p>Upload base image to Docker Hub: docker tag &lt;container&gt; [DockerUserName/Repository[:tag]] docker push [DockerUserName/Repository[:tag]]</p><p>Run open up new terminals to access Container (example): Look at the current containers available with $ docker container ls CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES ce4096e14bef        mavs                &quot;/ros_entrypoint.sh …&quot;   34 minutes ago      Up 34 minutes                           vigilant_johnson Open terminal docker exec -it vigilant_johnson /bin/bash Note: you can use “tab” key to auto-complete the &lt;container_name&gt;</p><h2><a class="nav-anchor" id="Docker-hub-1" href="#Docker-hub-1">Docker hub</a></h2><h2><a class="nav-anchor" id="How-to-update-base-image-on-docker-hub-1" href="#How-to-update-base-image-on-docker-hub-1">How to update base image on docker hub</a></h2><ol><li><p>Run</p></li></ol><pre><code class="language-none">$sh build.sh</code></pre><ol><li><p>login to docker</p></li></ol><pre><code class="language-none">$docker login</code></pre><ol><li><p>ensure the name of the image</p></li></ol><pre><code class="language-none">$docker image ls</code></pre><p>Currently this should be avpg_base, where the image name is specified in the build.sh script</p><ol><li><p>tag the image</p></li></ol><pre><code class="language-none">$docker tag avpg_base avpg/cain:base_cudagl</code></pre><p>assuming that the image name is avpg_base</p><ol><li><p>publish the image</p></li></ol><pre><code class="language-none">$docker push avpg/cain:base_cudagl</code></pre><p>see the <a href="https://docs.docker.com/get-started/part2/#build-the-app">docker tutorial on containers</a> for more detailed instructions</p><h2><a class="nav-anchor" id="Pull-and-run-the-image-from-the-remote-repository-1" href="#Pull-and-run-the-image-from-the-remote-repository-1">Pull and run the image from the remote repository</a></h2><p>It would be interesting to try this with the higher-level image, but this is <em>not yet tested</em>.</p><pre><code class="language-none">docker run -p 4000:80 avpg/cain:base_cudagl</code></pre><footer><hr/><a class="previous" href="workflow.html"><span class="direction">Previous</span><span class="title">Workflow</span></a><a class="next" href="../testing/main.html"><span class="direction">Next</span><span class="title">Testing</span></a></footer></article></body></html>
